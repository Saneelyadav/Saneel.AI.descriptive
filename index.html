<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IBPS PO Mains Descriptive Test Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        .font-lora {
            font-family: 'Lora', serif;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            position: relative;
        }
        .logo {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            font-weight: 700;
            color: #475569; /* slate-600 */
            font-size: 1.25rem;
        }
        textarea:focus, button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); /* blue-500 with opacity */
        }
        .tab-btn {
            transition: all 0.2s ease-in-out;
            border-bottom: 4px solid transparent;
        }
        .tab-btn.active {
            border-bottom-color: #3b82f6; /* blue-600 */
            color: #1e3a8a; /* blue-900 */
        }
        .test-select-btn {
            transition: all 0.2s ease-in-out;
        }
        #final-content-display {
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: #f8fafc; /* slate-50 */
            border: 1px solid #e2e8f0; /* slate-200 */
            border-radius: 0.5rem;
            padding: 1rem;
            max-height: 50vh;
            overflow-y: auto;
            font-family: 'Lora', serif;
        }
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="app-container" class="w-full max-w-6xl mx-auto">
        
        <!-- Start Screen -->
        <div id="start-screen" class="screen active card p-8 text-center">
            <div class="logo">Saneel.AI</div>
            <h1 class="text-4xl font-bold text-gray-800 mb-2 font-lora">IBPS PO Mains Descriptive Test</h1>
            <p class="text-gray-600 mb-4 text-lg">Practice Simulation</p>
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-2xl mx-auto text-left space-y-2">
                <p><strong>Pattern:</strong> 30 minutes for Essay & Reading Comprehension.</p>
                <p>Click "Proceed" to select a test set.</p>
            </div>
            <button id="proceed-btn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors shadow-md text-lg mt-6">
                Proceed
            </button>
        </div>

        <!-- Test Selection Screen -->
        <div id="test-selection-screen" class="screen card p-8 text-center">
            <div class="logo">Saneel.AI</div>
            <h2 class="text-3xl font-bold text-gray-800 mb-6 font-lora">Select a Practice Test</h2>
            <div id="test-list-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Test buttons will be injected here -->
            </div>
        </div>

        <!-- Test Screen -->
        <div id="test-screen" class="screen card">
            <header class="p-4 bg-gray-50 flex justify-between items-center border-b border-gray-200 rounded-t-lg">
                <h2 class="text-xl font-bold text-gray-800">Descriptive Test</h2>
                 <div class="logo !static !top-0 !right-0">Saneel.AI</div>
                <div id="timer-container" class="bg-red-100 text-red-800 text-lg font-semibold px-4 py-2 rounded-full">
                    Time Left: <span id="timer">30:00</span>
                </div>
            </header>
            <div class="p-6">
                <div class="flex border-b border-gray-200 mb-4">
                    <button id="essay-tab-btn" class="tab-btn active text-lg font-semibold py-2 px-6">Essay Writing</button>
                    <button id="rc-tab-btn" class="tab-btn text-lg font-semibold py-2 px-6">Reading Comprehension</button>
                </div>
                <div id="essay-section">
                    <div class="bg-gray-100 p-4 rounded-lg mb-4"><p class="font-semibold text-gray-700">Question:</p><p id="essay-prompt" class="text-gray-900"></p></div>
                    <textarea id="essay-area" spellcheck="false" class="w-full h-[30rem] border border-gray-300 rounded-lg p-4 text-gray-700 font-lora text-base resize-none" placeholder="Start writing your essay here..."></textarea>
                    <p class="text-right text-sm text-gray-500 mt-1">Word Count: <span id="essay-word-count">0</span></p>
                </div>
                <div id="rc-section" class="hidden h-[33rem] overflow-y-auto pr-2">
                    <div class="bg-gray-100 p-4 rounded-lg mb-4"><p class="font-semibold text-gray-700 mb-2">Read the following passage carefully and answer the questions that follow:</p><p id="rc-passage" class="text-gray-800 font-lora text-base leading-relaxed"></p></div>
                    <div id="rc-questions-container" class="space-y-4"></div>
                </div>
                <div class="text-center mt-6">
                    <button id="submit-btn" class="bg-green-600 text-white font-bold py-3 px-12 rounded-lg hover:bg-green-700 transition-colors shadow-md text-lg disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>Submit Test</button>
                </div>
            </div>
        </div>
        
        <!-- Copy Content Screen -->
        <div id="copy-content-screen" class="screen card p-8">
            <div class="logo">Saneel.AI</div>
            <h2 class="text-3xl font-bold text-center mb-4 text-gray-800 font-lora">Test Submitted Successfully</h2>
            <p class="text-center text-gray-600 mb-6">Copy your responses below to analyze them with an external tool.</p>
            <pre id="final-content-display"></pre>
            <div class="flex justify-center items-center gap-4 mt-8">
                <button id="copy-btn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors shadow-md text-lg">Copy to Clipboard</button>
                <button id="try-again-btn" class="bg-gray-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-700 transition-colors shadow-md text-lg">Take Another Test</button>
            </div>
        </div>
    </div>

    <script type="module">
        // --- DOM Element References ---
        const screens = document.querySelectorAll('.screen');
        const proceedBtn = document.getElementById('proceed-btn');
        const testListContainer = document.getElementById('test-list-container');
        const submitBtn = document.getElementById('submit-btn');
        const tryAgainBtn = document.getElementById('try-again-btn');
        const copyBtn = document.getElementById('copy-btn');
        const finalContentDisplay = document.getElementById('final-content-display');
        const essayTabBtn = document.getElementById('essay-tab-btn');
        const rcTabBtn = document.getElementById('rc-tab-btn');
        const essaySection = document.getElementById('essay-section');
        const rcSection = document.getElementById('rc-section');
        const timerEl = document.getElementById('timer');
        const essayPromptEl = document.getElementById('essay-prompt');
        const essayArea = document.getElementById('essay-area');
        const essayWordCountEl = document.getElementById('essay-word-count');
        const rcPassageEl = document.getElementById('rc-passage');
        const rcQuestionsContainer = document.getElementById('rc-questions-container');

        // --- App State ---
        let timerInterval;
        let currentTestSet;
        const TEST_DURATION_SECONDS = 1800; // 30 minutes

        // --- All Test Content (UPDATED with 5 questions each) ---
        const testSets = [
            { name: "Test 1", essayTopic: "Impact of Artificial Intelligence on the Indian Banking Sector.", comprehension: { passage: "The Reserve Bank of India (RBI) has been the cornerstone of the country's financial system since its establishment in 1935. Its primary objective is to maintain monetary stability. Beyond its traditional role, it now acts as a regulator and supervisor of the banking and financial systems, a manager of foreign exchange, and a developmental agency promoting financial inclusion. One of the RBI's most critical tools is the monetary policy, through which it influences interest rates to control inflation and stimulate economic growth.", questions: ["What is the primary objective of the RBI?", "Name three functions of the RBI beyond its traditional role.", "What is the main purpose of the RBI's monetary policy?", "How does the RBI promote financial inclusion according to the passage?", "When was the RBI established?"] }},
            { name: "Test 2", essayTopic: "The Gig Economy in India: Pros and Cons.", comprehension: { passage: "Financial inclusion is ensuring access to appropriate financial products for all sections of society, particularly vulnerable groups. In India, the Pradhan Mantri Jan Dhan Yojana (PMJDY), launched in 2014, has been a game-changer. The scheme brought a large portion of the unbanked population into the formal financial system by providing a basic savings bank account, and access to credit and insurance. While progress has been made, challenges such as low account usage in rural areas and the need for financial literacy remain.", questions: ["Define 'financial inclusion' based on the passage.", "What scheme was launched in 2014 to promote financial inclusion?", "What are two remaining challenges in achieving full financial inclusion?", "What specific services are provided through the PMJDY scheme?", "Which groups are specifically mentioned as vulnerable?"] }},
            { name: "Test 3", essayTopic: "The Role of Digital Payments in achieving a Cashless Society.", comprehension: { passage: "The Monetary Policy Committee (MPC), established in 2016, is responsible for fixing the benchmark policy rate (repo rate) required to achieve the inflation target. This shift to an inflation-targeting framework has brought more transparency and accountability to India's monetary policy decisions. The committee comprises six members: three from the RBI and three appointed by the central government. Decisions are made by majority vote, with the RBI Governor having a casting vote in case of a tie.", questions: ["What is the primary responsibility of the MPC?", "How has the MPC framework improved India's monetary policy?", "How are decisions made in the MPC, especially in case of a tie?", "When was the MPC established?", "What is the composition of the MPC in terms of its members?"] }},
            { name: "Test 4", essayTopic: "Privatization of Public Sector Banks: A Boon or a Bane?", comprehension: { passage: "Non-Performing Assets (NPAs) are loans or advances for which the principal or interest payment remained overdue for a period of 90 days. A high level of NPAs affects a bank's profitability and can erode its capital base. The Insolvency and Bankruptcy Code (IBC) was enacted in 2016 to create a consolidated framework that would resolve insolvency in a time-bound manner. The IBC has been a significant step in cleaning up the balance sheets of Indian banks and improving the credit culture.", questions: ["What is a Non-Performing Asset (NPA)?", "How does a high level of NPAs impact a bank?", "What was the purpose of enacting the Insolvency and Bankruptcy Code (IBC)?", "What is the time period after which a loan is classified as an NPA?", "What has been a significant outcome of the IBC according to the passage?"] }}
        ];

        // --- Central function to manage screen visibility ---
        function showScreen(screenId) {
            screens.forEach(screen => {
                screen.classList.toggle('active', screen.id === screenId);
            });
        }

        // --- Event Listeners ---
        proceedBtn.addEventListener('click', () => showScreen('test-selection-screen'));
        submitBtn.addEventListener('click', () => handleSubmit(false));
        tryAgainBtn.addEventListener('click', resetApp);
        copyBtn.addEventListener('click', copyContentToClipboard);
        essayTabBtn.addEventListener('click', () => switchTab('essay'));
        rcTabBtn.addEventListener('click', () => switchTab('rc'));
        essayArea.addEventListener('input', () => {
            updateWordCount();
            updateSubmitButtonState();
        });

        function populateTestSelection() {
            testListContainer.innerHTML = '';
            testSets.forEach((test, index) => {
                const button = document.createElement('button');
                button.className = "test-select-btn bg-white hover:bg-blue-50 border-2 border-blue-200 text-blue-800 font-semibold py-6 px-4 rounded-lg shadow-sm";
                button.textContent = test.name;
                button.onclick = () => startTest(index);
                testListContainer.appendChild(button);
            });
        }

        // --- UPDATED: This function is changed to include word counters ---
        function startTest(testIndex) {
            currentTestSet = testSets[testIndex];
            
            showScreen('test-screen');
            
            essayPromptEl.textContent = currentTestSet.essayTopic;
            rcPassageEl.textContent = currentTestSet.comprehension.passage;
            rcQuestionsContainer.innerHTML = '';
            currentTestSet.comprehension.questions.forEach((q, index) => {
                const questionBlock = document.createElement('div');
                
                const questionText = document.createElement('p');
                questionText.className = "font-semibold text-gray-700 mb-1";
                questionText.textContent = `Q${index + 1}: ${q}`;
                
                const textArea = document.createElement('textarea');
                textArea.id = `rc-a${index}`;
                textArea.spellcheck = false;
                textArea.className = "w-full h-24 border border-gray-300 rounded-lg p-2 text-gray-700 font-lora text-base resize-none";
                textArea.placeholder = `Write your answer for Q${index + 1}...`;
                textArea.addEventListener('input', () => {
                    updateRcWordCount(index);
                    updateSubmitButtonState();
                });

                const wordCountContainer = document.createElement('div');
                wordCountContainer.className = 'text-right text-sm text-gray-500 mt-1';
                wordCountContainer.innerHTML = `Word Count: <span id="rc-word-count-${index}">0</span>`;

                questionBlock.appendChild(questionText);
                questionBlock.appendChild(textArea);
                questionBlock.appendChild(wordCountContainer);
                rcQuestionsContainer.appendChild(questionBlock);
            });
            
            let timeLeft = TEST_DURATION_SECONDS;
            updateTimerDisplay(timeLeft);
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay(timeLeft);
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerEl.textContent = "00:00";
                    handleSubmit(true); 
                }
            }, 1000);
        }
        
        function updateTimerDisplay(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            timerEl.textContent = `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        function handleSubmit(isAutoSubmit) {
            clearInterval(timerInterval);
            if(isAutoSubmit) console.log("Time's up! Submitting automatically.");

            const essayText = essayArea.value;
            const rcPassage = currentTestSet.comprehension.passage;
            const rcAnswers = currentTestSet.comprehension.questions.map((q, index) => {
                const answerText = document.getElementById(`rc-a${index}`).value;
                return `Question ${index + 1}: ${q}\nAnswer: ${answerText || 'Not Answered'}`;
            }).join('\n\n');

            const fullContent = `IBPS PO Mains Descriptive Practice\n================================\n\nEssay Topic:\n${currentTestSet.essayTopic}\n\nMy Essay:\n${essayText || 'Not Answered'}\n\n================================\n\nReading Comprehension Passage:\n${rcPassage}\n\nMy Answers:\n${rcAnswers}\n`;
            
            finalContentDisplay.textContent = fullContent;
            showScreen('copy-content-screen');
        }

        function copyContentToClipboard() {
            const textToCopy = finalContentDisplay.textContent;
            const textArea = document.createElement("textarea");
            textArea.style.position = 'fixed';
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                copyBtn.textContent = 'Copied!';
                copyBtn.classList.replace('bg-blue-600', 'bg-green-600');
                setTimeout(() => {
                    copyBtn.textContent = 'Copy to Clipboard';
                    copyBtn.classList.replace('bg-green-600', 'bg-blue-600');
                }, 2000);
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }
            document.body.removeChild(textArea);
        }
        
        function resetApp() {
            showScreen('start-screen');
            essayArea.value = '';
            updateWordCount();
            switchTab('essay');
            submitBtn.disabled = true;
        }
        
        function switchTab(tab) {
            essaySection.classList.toggle('hidden', tab !== 'essay');
            rcSection.classList.toggle('hidden', tab === 'essay');
            essayTabBtn.classList.toggle('active', tab === 'essay');
            rcTabBtn.classList.toggle('active', tab !== 'essay');
        }
        
        function updateSubmitButtonState() {
            let hasContent = document.getElementById('essay-area').value.trim().length > 0;
            if (!hasContent) {
                const rcTextareas = rcQuestionsContainer.querySelectorAll('textarea');
                for (const ta of rcTextareas) {
                    if (ta.value.trim().length > 0) {
                        hasContent = true;
                        break;
                    }
                }
            }
            submitBtn.disabled = !hasContent;
        }

        function updateWordCount() {
            const words = essayArea.value.trim().split(/\s+/).filter(word => word.length > 0);
            essayWordCountEl.textContent = words.length;
        }

        // --- NEW: Function to update word count for RC answers ---
        function updateRcWordCount(index) {
            const textArea = document.getElementById(`rc-a${index}`);
            const wordCountEl = document.getElementById(`rc-word-count-${index}`);
            if (textArea && wordCountEl) {
                const words = textArea.value.trim().split(/\s+/).filter(word => word.length > 0);
                wordCountEl.textContent = words.length;
            }
        }

        // --- Initial Setup ---
        populateTestSelection();
        showScreen('start-screen');
    </script>
</body>
</html>
